IRQs: 中断请求；
PIT: 可编程间隔计时器。

# IRQs

cpu 有两种方式与外界通信：
1. 轮询，cpu 循环检测设备是否就绪；
2. 中断，设备就绪时，触发一个 cpu 中断；

## PIC（可编程中断控制器）

在现代 PC 中，有15个中断号，你可以重新映射每个 IRQ 线提供的中断号。计算机启动时，默认中断映射为：

* IRQ 0..7 - INT 0x8..0xF
* IRQ 8..15 - INT 0x70..0x77
   
由于 `0x8..0xF` 中断号被 cpu 内部占用了，为解决这个冲突，需要重新映射中断号，使 `IRQ 0..7 - INT 0x32..0x40` 。

## IO控制

中断控制器使用IO总线进行通信，每一个控制器都有2根总线：
- Master - command bus: 0x20, data bus: 0x21
- Slave - command bus: 0xA0, data bus: 0xA1

## [现代 APIC 已经取代了 PIC](https://wiki.osdev.org/PIC)



# PIT (可编程间隔定时器)

PIT 是一个连接到 IRQ0 bus 的芯片，可以定义中断 CPU 的速率，PIT 是实现系统时钟和中断切换多进程的唯一方法。

PIT 有一个内部时钟，频率为 1.1931MHz，可以调节最终的输出频率，它有 3 个通道：

* 通道 0 是最有用的，它的输出连接到 IRQ0；
* 通道 1 无用，在现代硬件不再实现，它用于控制 DRAM 的刷新率；
* 通道 2 控制 PC 扬声器；

我们要使用的就是通道 0；

PIT 有 4 个 IO 总线，`0x40 - 0x42`为通道`0 - 2`的数据总线，`0x43`为命令总线。

